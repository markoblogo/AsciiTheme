(function(o,f){typeof exports=="object"&&typeof module<"u"?f(exports):typeof define=="function"&&define.amd?define(["exports"],f):(o=typeof globalThis<"u"?globalThis:o||self,f(o.AsciiTheme={}))})(this,(function(o){"use strict";const f=document.documentElement;function w(){return f}function k(e,t=document){return Array.from(t.querySelectorAll(e))}function C(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function p(e){try{const t=localStorage.getItem(e);if(!t)return{};const i=JSON.parse(t);if(!i||typeof i!="object")return{};const a=i;return{style:a.style==="ascii"?"ascii":a.style==="default"?"default":void 0,mode:a.mode==="dark"?"dark":a.mode==="light"?"light":void 0}}catch{return{}}}function O(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch{}}const y="asciiOriginalHtml",M="data-ascii-sticker-rendered",j="pre.ascii-sticker";function v(e,t=2){const i=e.replace(/\s+/g," ").trim(),a=`${" ".repeat(t)}${i}${" ".repeat(t)}`,u=`┌${"─".repeat(a.length)}┐`,d=`│${a}│`,R=`└${"─".repeat(a.length)}┘`;return`${u}
${d}
${R}`}function P(e){e.dataset[y]||(e.dataset[y]=e.innerHTML);const t=(e.getAttribute("data-ascii-sticker")||"").trim();if(!t)return;const i=e.querySelector(j);if(e.getAttribute(M)==="1"&&i){i.textContent=v(t);return}e.innerHTML="";const a=document.createElement("pre");a.className="ascii-sticker",a.textContent=v(t),e.matches("button, a, [role='button']")&&e.setAttribute("aria-label",t),e.appendChild(a),e.setAttribute(M,"1")}function q(e){const t=e.dataset[y];t!==void 0&&(e.innerHTML=t,e.removeAttribute(M))}function I(e=document){const t=k("[data-ascii-sticker]",e);for(const i of t)P(i)}function x(e=document){const t=k("[data-ascii-sticker]",e);for(const i of t)q(i)}const s={storageKey:"ascii_theme_v1",defaultStyle:"default",managedMode:!1,defaultMode:"light",themeAttr:"data-theme",integrateTheme:"auto",addThemeToggle:!1,addStyleToggle:!1,mountSelector:"",mountPlacement:"append",icons:{sun:"☀",moon:"☾"},className:""};let n={...s};const r=w();let l=null,m=null,h=null;function T(e){return e==="ascii"?"ascii":"default"}function c(e){return e==="dark"?"dark":"light"}function S(e){const t=r.getAttribute(e);if(t==="dark"||t==="light")return t;const i=r.getAttribute("data-theme");return i==="dark"||i==="light"?i:r.classList.contains("dark")?"dark":(r.classList.contains("light"),"light")}function _(e){const t=r.getAttribute(e);if(t==="dark"||t==="light")return{hasHostTheme:!0,mode:t};const i=r.getAttribute("data-theme");return i==="dark"||i==="light"?{hasHostTheme:!0,mode:i}:r.classList.contains("dark")?{hasHostTheme:!0,mode:"dark"}:r.classList.contains("light")?{hasHostTheme:!0,mode:"light"}:{hasHostTheme:!1}}function B(e){const t=e.integrateTheme??s.integrateTheme,i=e.addThemeToggle??s.addThemeToggle,a=e.managedMode,u=e.defaultMode?c(e.defaultMode):C();if(t==="managed")return{managedMode:!0,addThemeToggle:i,defaultMode:u};if(t==="respect")return{managedMode:!1,addThemeToggle:!1,defaultMode:S(e.themeAttr??s.themeAttr)};const d=e.detectTheme?e.detectTheme(r):_(e.themeAttr??s.themeAttr);return e.hasHostTheme??d.hasHostTheme?{managedMode:!1,addThemeToggle:!1,defaultMode:c(d.mode??S(e.themeAttr??s.themeAttr))}:{managedMode:a??(i?!0:s.managedMode),addThemeToggle:i,defaultMode:u}}function D(e){if(!n.managedMode){r.removeAttribute("data-ascii-mode");return}const t=c(e??n.defaultMode);r.setAttribute("data-ascii-mode",t)}function H(e,t){const i=p(n.storageKey);O(n.storageKey,{...i,style:e,mode:n.managedMode?t:void 0})}function K(){return n.managedMode?c(r.getAttribute("data-ascii-mode")):S(n.themeAttr)}function g(){if(m){const t=A()!=="ascii";m.textContent=t?"ASCII":"Default",m.setAttribute("aria-label",t?"Switch to ASCII style":"Switch to default style")}if(l){const e=K(),t=e==="dark"?n.icons.moon??"☾":n.icons.sun??"☀";l.textContent=t,l.setAttribute("aria-label",e==="dark"?"Switch to light mode":"Switch to dark mode")}}function E(e,t){const i=document.createElement("button");return i.type="button",i.className=`ascii-theme-toggle-btn ${t}`.trim(),i.dataset.asciiToggleType=e,i}function z(){var d;const e=n.mountSelector;if(!(!!e&&(n.addThemeToggle||n.addStyleToggle))||!e)return;const i=document.querySelector(e);if(!i)return;h!=null&&h.parentElement&&h.remove();const a=document.createElement("div");a.className="ascii-theme-toggle-group",a.setAttribute("data-ascii-controls","1");const u=((d=n.className)==null?void 0:d.trim())||"";n.addThemeToggle?(l=E("theme",u),l.addEventListener("click",()=>{N(),g()})):l=null,n.addStyleToggle?(m=E("style",u),m.addEventListener("click",()=>{L(),g()})):m=null,l&&a.append(l),m&&a.append(m),n.mountPlacement==="prepend"?i.prepend(a):i.append(a),h=a,g()}function b(e){const t=T(e);r.setAttribute("data-style",t),t==="ascii"?I(document):x(document);const i=n.managedMode?c(r.getAttribute("data-ascii-mode")):void 0;return H(t,i),g(),t}function J(e={}){const t=B(e);n={...s,...e,managedMode:t.managedMode,addThemeToggle:t.addThemeToggle,defaultStyle:T(e.defaultStyle??s.defaultStyle),defaultMode:t.defaultMode},n.mountPlacement==="afterThemeToggle"&&!n.addThemeToggle&&(n.mountPlacement="append");const i=p(n.storageKey),a=T(i.style??n.defaultStyle);if(n.managedMode)D(i.mode??n.defaultMode);else if(r.removeAttribute("data-ascii-mode"),n.themeAttr!=="data-theme"){const d=r.getAttribute(n.themeAttr);(d==="light"||d==="dark")&&r.setAttribute("data-theme",d)}z();const u=b(a);return g(),u}function U(e){return b(e)}function L(){const e=A();return b(e==="ascii"?"default":"ascii")}function A(){return T(r.getAttribute("data-style"))}function $(e){if(!n.managedMode)return c(r.getAttribute(n.themeAttr));const t=c(e);return r.setAttribute("data-ascii-mode",t),H(A(),t),g(),t}function N(){if(!n.managedMode)return c(r.getAttribute(n.themeAttr));const e=c(r.getAttribute("data-ascii-mode"));return $(e==="dark"?"light":"dark")}function F(e=document){I(e)}o.getAsciiStyle=A,o.initAsciiTheme=J,o.renderAsciiStickers=F,o.setAsciiMode=$,o.setAsciiStyle=U,o.toggleAsciiMode=N,o.toggleAsciiStyle=L,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})}));
