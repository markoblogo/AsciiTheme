(function(r,m){typeof exports=="object"&&typeof module<"u"?m(exports):typeof define=="function"&&define.amd?define(["exports"],m):(r=typeof globalThis<"u"?globalThis:r||self,m(r.AsciiTheme={}))})(this,(function(r){"use strict";const m=document.documentElement;function w(){return m}function M(t,e=document){return Array.from(e.querySelectorAll(t))}function C(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function k(t){try{const e=localStorage.getItem(t);if(!e)return{};const n=JSON.parse(e);if(!n||typeof n!="object")return{};const o=n;return{style:o.style==="ascii"?"ascii":o.style==="default"?"default":void 0,mode:o.mode==="dark"?"dark":o.mode==="light"?"light":void 0}}catch{return{}}}function O(t,e){try{localStorage.setItem(t,JSON.stringify(e))}catch{}}const b="asciiOriginalHtml",T="data-ascii-sticker-rendered",j="pre.ascii-sticker";function v(t,e=2){const n=t.replace(/\s+/g," ").trim(),o=`${" ".repeat(e)}${n}${" ".repeat(e)}`,l=`┌${"─".repeat(o.length)}┐`,f=`│${o}│`,h=`└${"─".repeat(o.length)}┘`;return`${l}
${f}
${h}`}function P(t){t.dataset[b]||(t.dataset[b]=t.innerHTML);const e=(t.getAttribute("data-ascii-sticker")||"").trim();if(!e)return;const n=t.querySelector(j);if(t.getAttribute(T)==="1"&&n){n.textContent=v(e);return}t.innerHTML="";const o=document.createElement("pre");o.className="ascii-sticker",o.textContent=v(e),t.matches("button, a, [role='button']")&&t.setAttribute("aria-label",e),t.appendChild(o),t.setAttribute(T,"1")}function x(t){const e=t.dataset[b];e!==void 0&&(t.innerHTML=e,t.removeAttribute(T))}function E(t=document){const e=M("[data-ascii-sticker]",t);for(const n of e)P(n)}function _(t=document){const e=M("[data-ascii-sticker]",t);for(const n of e)x(n)}const g={storageKey:"ascii_theme_v1",defaultStyle:"default",managedMode:!1,defaultMode:"light",themeAttr:"data-theme",addThemeToggle:!1,addStyleToggle:!1,mountSelector:"",mountPlacement:"append",icons:{sun:"☀",moon:"☾"},className:""};let i={...g};const a=w();let s=null,d=null,A=null;function y(t){return t==="ascii"?"ascii":"default"}function c(t){return t==="dark"?"dark":"light"}function B(t){if(!i.managedMode){a.removeAttribute("data-ascii-mode");return}const e=c(t??i.defaultMode);a.setAttribute("data-ascii-mode",e)}function I(t,e){const n=k(i.storageKey);O(i.storageKey,{...n,style:t,mode:i.managedMode?e:void 0})}function H(){return i.managedMode?c(a.getAttribute("data-ascii-mode")):c(a.getAttribute(i.themeAttr))}function u(){if(d){const e=S()!=="ascii";d.textContent=e?"ASCII":"Default",d.setAttribute("aria-label",e?"Switch to ASCII style":"Switch to default style")}if(s){const t=H(),e=t==="dark"?i.icons.moon??"☾":i.icons.sun??"☀";s.textContent=e,s.setAttribute("aria-label",t==="dark"?"Switch to light mode":"Switch to dark mode")}}function $(t,e){const n=document.createElement("button");return n.type="button",n.className=`ascii-theme-toggle-btn ${e}`.trim(),n.dataset.asciiToggleType=t,n}function q(){var f;const t=i.mountSelector;if(!(!!t&&(i.addThemeToggle||i.addStyleToggle))||!t)return;const n=document.querySelector(t);if(!n)return;A!=null&&A.parentElement&&A.remove();const o=document.createElement("div");o.className="ascii-theme-toggle-group",o.setAttribute("data-ascii-controls","1");const l=((f=i.className)==null?void 0:f.trim())||"";i.addThemeToggle?(s=$("theme",l),s.addEventListener("click",()=>{R(),u()})):s=null,i.addStyleToggle?(d=$("style",l),d.addEventListener("click",()=>{N(),u()})):d=null,s&&o.append(s),d&&o.append(d),i.mountPlacement==="prepend"?n.prepend(o):n.append(o),A=o,u()}function p(t){const e=y(t);a.setAttribute("data-style",e),e==="ascii"?E(document):_(document);const n=i.managedMode?c(a.getAttribute("data-ascii-mode")):void 0;return I(e,n),u(),e}function D(t={}){const e=t.managedMode??g.managedMode,n=t.defaultMode?c(t.defaultMode):e?C():g.defaultMode;i={...g,...t,managedMode:e,defaultStyle:y(t.defaultStyle??g.defaultStyle),defaultMode:n},i.mountPlacement==="afterThemeToggle"&&!i.addThemeToggle&&(i.mountPlacement="append");const o=k(i.storageKey),l=y(o.style??i.defaultStyle);if(i.managedMode)B(o.mode??i.defaultMode);else if(a.removeAttribute("data-ascii-mode"),i.themeAttr!=="data-theme"){const h=a.getAttribute(i.themeAttr);(h==="light"||h==="dark")&&a.setAttribute("data-theme",h)}q();const f=p(l);return u(),f}function K(t){return p(t)}function N(){const t=S();return p(t==="ascii"?"default":"ascii")}function S(){return y(a.getAttribute("data-style"))}function L(t){if(!i.managedMode)return c(a.getAttribute(i.themeAttr));const e=c(t);return a.setAttribute("data-ascii-mode",e),I(S(),e),u(),e}function R(){if(!i.managedMode)return c(a.getAttribute(i.themeAttr));const t=c(a.getAttribute("data-ascii-mode"));return L(t==="dark"?"light":"dark")}function z(t=document){E(t)}r.getAsciiStyle=S,r.initAsciiTheme=D,r.renderAsciiStickers=z,r.setAsciiMode=L,r.setAsciiStyle=K,r.toggleAsciiMode=R,r.toggleAsciiStyle=N,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})}));
