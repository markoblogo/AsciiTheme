(function(d,r){typeof exports=="object"&&typeof module<"u"?r(exports):typeof define=="function"&&define.amd?define(["exports"],r):(d=typeof globalThis<"u"?globalThis:d||self,r(d.AsciiTheme={}))})(this,(function(d){"use strict";function r(){return document.documentElement}function I(e,t=document){return Array.from(t.querySelectorAll(e))}function w(){return typeof window>"u"||typeof window.matchMedia!="function"?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function O(){return w()}function H(e){try{const t=localStorage.getItem(e);if(!t)return{};const o=JSON.parse(t);if(!o||typeof o!="object")return{};const n=o;return{style:n.style==="ascii"?"ascii":n.style==="default"?"default":void 0,mode:n.mode==="dark"?"dark":n.mode==="light"?"light":void 0}}catch{return{}}}function S(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch{}}const k="asciiOriginalHtml",p="data-ascii-sticker-rendered",P="pre.ascii-sticker";function E(e,t=2){const o=e.replace(/\s+/g," ").trim(),n=`${" ".repeat(t)}${o}${" ".repeat(t)}`,i=`┌${"─".repeat(n.length)}┐`,l=`│${n}│`,h=`└${"─".repeat(n.length)}┘`;return`${i}
${l}
${h}`}function q(e){e.dataset[k]||(e.dataset[k]=e.innerHTML);const t=(e.getAttribute("data-ascii-sticker")||"").trim();if(!t)return;const o=e.querySelector(P);if(e.getAttribute(p)==="1"&&o){o.textContent=E(t);return}e.innerHTML="";const n=document.createElement("pre");n.className="ascii-sticker",n.textContent=E(t),e.matches("button, a, [role='button']")&&e.setAttribute("aria-label",t),e.appendChild(n),e.setAttribute(p,"1")}function x(e){const t=e.dataset[k];t!==void 0&&(e.innerHTML=t,e.removeAttribute(p))}function L(e=document){const t=I("[data-ascii-sticker]",e);for(const o of t)q(o)}function B(e=document){const t=I("[data-ascii-sticker]",e);for(const o of t)x(o)}const s={storageKey:"ascii_theme_v1",defaultStyle:"default",managedMode:!1,defaultMode:"light",themeAttr:"data-theme",integrateTheme:"auto",addThemeToggle:!1,addStyleToggle:!1,mountSelector:"",mountPlacement:"append",icons:{sun:"☀",moon:"☾"},className:"",base:!1};let a={...s},u=null,m=null,T=null;function y(e){return e==="ascii"?"ascii":"default"}function c(e){return e==="dark"?"dark":"light"}function A(e){const t=r(),o=t.getAttribute(e);if(o==="dark"||o==="light")return o;const n=t.getAttribute("data-theme");return n==="dark"||n==="light"?n:t.classList.contains("dark")?"dark":(t.classList.contains("light"),"light")}function K(e){const t=r(),o=t.getAttribute(e);if(o==="dark"||o==="light")return{hasHostTheme:!0,mode:o};const n=t.getAttribute("data-theme");return n==="dark"||n==="light"?{hasHostTheme:!0,mode:n}:t.classList.contains("dark")?{hasHostTheme:!0,mode:"dark"}:t.classList.contains("light")?{hasHostTheme:!0,mode:"light"}:{hasHostTheme:!1}}function _(e){const t=e.integrateTheme??s.integrateTheme,o=e.addThemeToggle??s.addThemeToggle,n=e.managedMode,i=e.defaultMode?c(e.defaultMode):O();if(t==="managed")return{managedMode:!0,addThemeToggle:o,defaultMode:i};if(t==="respect")return{managedMode:!1,addThemeToggle:!1,defaultMode:A(e.themeAttr??s.themeAttr)};const l=r(),h=e.detectTheme?e.detectTheme(l):K(e.themeAttr??s.themeAttr);return e.hasHostTheme??h.hasHostTheme?{managedMode:!1,addThemeToggle:!1,defaultMode:c(h.mode??A(e.themeAttr??s.themeAttr))}:{managedMode:n??(o?!0:s.managedMode),addThemeToggle:o,defaultMode:i}}function D(e){const t=r();if(!a.managedMode){t.removeAttribute("data-ascii-mode");return}const o=c(e??a.defaultMode);t.setAttribute("data-ascii-mode",o)}function $(e,t){const o=H(a.storageKey);S(a.storageKey,{...o,style:a.base?e:void 0,mode:a.managedMode?t:void 0})}function z(){if(a.managedMode){const e=r();return c(e.getAttribute("data-ascii-mode"))}return A(a.themeAttr)}function f(){if(m){const t=b()!=="ascii";m.textContent=t?"ASCII":"Default",m.setAttribute("aria-label",t?"Switch to ASCII style":"Switch to default style")}if(u){const e=z(),t=e==="dark"?a.icons.moon??"☾":a.icons.sun??"☀";u.textContent=t,u.setAttribute("aria-label",e==="dark"?"Switch to light mode":"Switch to dark mode")}}function N(e,t){const o=document.createElement("button");return o.type="button",o.className=`ascii-theme-toggle-btn ${t}`.trim(),o.dataset.asciiToggleType=e,o}function J(){var l;const e=a.mountSelector;if(!(!!e&&(a.addThemeToggle||a.addStyleToggle))||!e)return;const o=document.querySelector(e);if(!o)return;T!=null&&T.parentElement&&T.remove();const n=document.createElement("div");n.className="ascii-theme-toggle-group",n.setAttribute("data-ascii-controls","1");const i=((l=a.className)==null?void 0:l.trim())||"";a.addThemeToggle?(u=N("theme",i),u.addEventListener("click",()=>{j(),f()})):u=null,a.addStyleToggle&&!a.base?(m=N("style",i),m.addEventListener("click",()=>{C(),f()})):m=null,u&&n.append(u),m&&n.append(m),a.mountPlacement==="prepend"?o.prepend(n):o.append(n),T=n,f()}function M(e){const t=r(),o=a.base?"ascii":y(e);t.setAttribute("data-style",o),o==="ascii"?L(document):B(document);const n=a.managedMode?c(t.getAttribute("data-ascii-mode")):void 0;return $(o,n),f(),o}function U(e={}){const t=e.base??s.base;if(typeof window>"u"||typeof document>"u")return t?"ascii":y(e.defaultStyle??s.defaultStyle);const o={...e,managedMode:t?e.managedMode??!0:e.managedMode},n=_(o);a={...s,...o,base:t,managedMode:n.managedMode,addThemeToggle:n.addThemeToggle,addStyleToggle:t?!1:o.addStyleToggle??s.addStyleToggle,defaultStyle:t?"ascii":y(o.defaultStyle??s.defaultStyle),defaultMode:n.defaultMode},a.mountPlacement==="afterThemeToggle"&&!a.addThemeToggle&&(a.mountPlacement="append");const i=H(a.storageKey),l=a.base?"ascii":y(a.defaultStyle);if(a.managedMode){const g=i.mode?c(i.mode):e.defaultMode?c(e.defaultMode):w();D(g),(!i.mode||i.style)&&S(a.storageKey,{...i,style:a.base?l:void 0,mode:g})}else{const g=r();if(g.removeAttribute("data-ascii-mode"),i.style&&S(a.storageKey,{...i,style:void 0}),a.themeAttr!=="data-theme"){const v=g.getAttribute(a.themeAttr);(v==="light"||v==="dark")&&g.setAttribute("data-theme",v)}}J();const h=M(l);return f(),h}function F(e){return M(e)}function C(){if(a.base)return M("ascii");const e=b();return M(e==="ascii"?"default":"ascii")}function b(){if(a.base)return"ascii";const e=r();return y(e.getAttribute("data-style"))}function R(e){if(!a.managedMode)return c(A(a.themeAttr));const t=r(),o=c(e);return t.setAttribute("data-ascii-mode",o),$(b(),o),f(),o}function j(){if(!a.managedMode)return c(A(a.themeAttr));const e=r(),t=c(e.getAttribute("data-ascii-mode"));return R(t==="dark"?"light":"dark")}function G(e=document){L(e)}d.getAsciiStyle=b,d.initAsciiTheme=U,d.renderAsciiStickers=G,d.setAsciiMode=R,d.setAsciiStyle=F,d.toggleAsciiMode=j,d.toggleAsciiStyle=C,Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})}));
