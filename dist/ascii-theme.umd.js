(function(r,f){typeof exports=="object"&&typeof module<"u"?f(exports):typeof define=="function"&&define.amd?define(["exports"],f):(r=typeof globalThis<"u"?globalThis:r||self,f(r.AsciiTheme={}))})(this,(function(r){"use strict";const f=document.documentElement;function R(){return f}function v(e,t=document){return Array.from(t.querySelectorAll(e))}function C(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function I(e){try{const t=localStorage.getItem(e);if(!t)return{};const a=JSON.parse(t);if(!a||typeof a!="object")return{};const n=a;return{style:n.style==="ascii"?"ascii":n.style==="default"?"default":void 0,mode:n.mode==="dark"?"dark":n.mode==="light"?"light":void 0}}catch{return{}}}function j(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch{}}const M="asciiOriginalHtml",S="data-ascii-sticker-rendered",P="pre.ascii-sticker";function H(e,t=2){const a=e.replace(/\s+/g," ").trim(),n=`${" ".repeat(t)}${a}${" ".repeat(t)}`,s=`┌${"─".repeat(n.length)}┐`,l=`│${n}│`,b=`└${"─".repeat(n.length)}┘`;return`${s}
${l}
${b}`}function q(e){e.dataset[M]||(e.dataset[M]=e.innerHTML);const t=(e.getAttribute("data-ascii-sticker")||"").trim();if(!t)return;const a=e.querySelector(P);if(e.getAttribute(S)==="1"&&a){a.textContent=H(t);return}e.innerHTML="";const n=document.createElement("pre");n.className="ascii-sticker",n.textContent=H(t),e.matches("button, a, [role='button']")&&e.setAttribute("aria-label",t),e.appendChild(n),e.setAttribute(S,"1")}function x(e){const t=e.dataset[M];t!==void 0&&(e.innerHTML=t,e.removeAttribute(S))}function E(e=document){const t=v("[data-ascii-sticker]",e);for(const a of t)q(a)}function B(e=document){const t=v("[data-ascii-sticker]",e);for(const a of t)x(a)}const d={storageKey:"ascii_theme_v1",defaultStyle:"default",managedMode:!1,defaultMode:"light",themeAttr:"data-theme",integrateTheme:"auto",addThemeToggle:!1,addStyleToggle:!1,mountSelector:"",mountPlacement:"append",icons:{sun:"☀",moon:"☾"},className:"",base:!1};let i={...d};const o=R();let u=null,m=null,h=null;function T(e){return e==="ascii"?"ascii":"default"}function c(e){return e==="dark"?"dark":"light"}function k(e){const t=o.getAttribute(e);if(t==="dark"||t==="light")return t;const a=o.getAttribute("data-theme");return a==="dark"||a==="light"?a:o.classList.contains("dark")?"dark":(o.classList.contains("light"),"light")}function _(e){const t=o.getAttribute(e);if(t==="dark"||t==="light")return{hasHostTheme:!0,mode:t};const a=o.getAttribute("data-theme");return a==="dark"||a==="light"?{hasHostTheme:!0,mode:a}:o.classList.contains("dark")?{hasHostTheme:!0,mode:"dark"}:o.classList.contains("light")?{hasHostTheme:!0,mode:"light"}:{hasHostTheme:!1}}function D(e){const t=e.integrateTheme??d.integrateTheme,a=e.addThemeToggle??d.addThemeToggle,n=e.managedMode,s=e.defaultMode?c(e.defaultMode):C();if(t==="managed")return{managedMode:!0,addThemeToggle:a,defaultMode:s};if(t==="respect")return{managedMode:!1,addThemeToggle:!1,defaultMode:k(e.themeAttr??d.themeAttr)};const l=e.detectTheme?e.detectTheme(o):_(e.themeAttr??d.themeAttr);return e.hasHostTheme??l.hasHostTheme?{managedMode:!1,addThemeToggle:!1,defaultMode:c(l.mode??k(e.themeAttr??d.themeAttr))}:{managedMode:n??(a?!0:d.managedMode),addThemeToggle:a,defaultMode:s}}function K(e){if(!i.managedMode){o.removeAttribute("data-ascii-mode");return}const t=c(e??i.defaultMode);o.setAttribute("data-ascii-mode",t)}function L(e,t){const a=I(i.storageKey);j(i.storageKey,{...a,style:e,mode:i.managedMode?t:void 0})}function z(){return i.managedMode?c(o.getAttribute("data-ascii-mode")):k(i.themeAttr)}function g(){if(m){const t=y()!=="ascii";m.textContent=t?"ASCII":"Default",m.setAttribute("aria-label",t?"Switch to ASCII style":"Switch to default style")}if(u){const e=z(),t=e==="dark"?i.icons.moon??"☾":i.icons.sun??"☀";u.textContent=t,u.setAttribute("aria-label",e==="dark"?"Switch to light mode":"Switch to dark mode")}}function $(e,t){const a=document.createElement("button");return a.type="button",a.className=`ascii-theme-toggle-btn ${t}`.trim(),a.dataset.asciiToggleType=e,a}function J(){var l;const e=i.mountSelector;if(!(!!e&&(i.addThemeToggle||i.addStyleToggle))||!e)return;const a=document.querySelector(e);if(!a)return;h!=null&&h.parentElement&&h.remove();const n=document.createElement("div");n.className="ascii-theme-toggle-group",n.setAttribute("data-ascii-controls","1");const s=((l=i.className)==null?void 0:l.trim())||"";i.addThemeToggle?(u=$("theme",s),u.addEventListener("click",()=>{O(),g()})):u=null,i.addStyleToggle&&!i.base?(m=$("style",s),m.addEventListener("click",()=>{N(),g()})):m=null,u&&n.append(u),m&&n.append(m),i.mountPlacement==="prepend"?a.prepend(n):a.append(n),h=n,g()}function A(e){const t=i.base?"ascii":T(e);o.setAttribute("data-style",t),t==="ascii"?E(document):B(document);const a=i.managedMode?c(o.getAttribute("data-ascii-mode")):void 0;return L(t,a),g(),t}function U(e={}){const t=e.base??d.base,a={...e,managedMode:t?e.managedMode??!0:e.managedMode},n=D(a);i={...d,...a,base:t,managedMode:n.managedMode,addThemeToggle:n.addThemeToggle,addStyleToggle:t?!1:a.addStyleToggle??d.addStyleToggle,defaultStyle:t?"ascii":T(a.defaultStyle??d.defaultStyle),defaultMode:n.defaultMode},i.mountPlacement==="afterThemeToggle"&&!i.addThemeToggle&&(i.mountPlacement="append");const s=I(i.storageKey),l=i.base?"ascii":T(s.style??i.defaultStyle);if(i.managedMode)K(s.mode??i.defaultMode);else if(o.removeAttribute("data-ascii-mode"),i.themeAttr!=="data-theme"){const p=o.getAttribute(i.themeAttr);(p==="light"||p==="dark")&&o.setAttribute("data-theme",p)}J();const b=A(l);return g(),b}function F(e){return A(e)}function N(){if(i.base)return A("ascii");const e=y();return A(e==="ascii"?"default":"ascii")}function y(){return i.base?"ascii":T(o.getAttribute("data-style"))}function w(e){if(!i.managedMode)return c(o.getAttribute(i.themeAttr));const t=c(e);return o.setAttribute("data-ascii-mode",t),L(y(),t),g(),t}function O(){if(!i.managedMode)return c(o.getAttribute(i.themeAttr));const e=c(o.getAttribute("data-ascii-mode"));return w(e==="dark"?"light":"dark")}function G(e=document){E(e)}r.getAsciiStyle=y,r.initAsciiTheme=U,r.renderAsciiStickers=G,r.setAsciiMode=w,r.setAsciiStyle=F,r.toggleAsciiMode=O,r.toggleAsciiStyle=N,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})}));
